---
import testimonials from '../data/testimonials.json';

const toDisplayName = (name) => {
  const parts = name.trim().split(/\s+/);

  if (parts.length === 1) {
    return name;
  }

  const firstName = parts[0];
  const lastInitial = parts[1][0].toUpperCase();
  return `${firstName} ${lastInitial}.`;
};

const starIcons = Array.from({ length: 5 }, () => '★');
---

<section id="testimonials" class="bg-[#fffaf0] px-6 py-20 lg:px-10">
  <div class="mx-auto max-w-7xl">
    <div class="mx-auto max-w-3xl text-center">
      <p class="text-sm font-semibold uppercase tracking-[0.2em] text-amber-700">Testimonials</p>
      <h2 class="mt-3 text-3xl text-[#2d1810] sm:text-4xl">What Our Customers Say</h2>
      <p class="mt-4 text-base text-[#5b4c3f] sm:text-lg">4.9 out of 5 stars from 200+ orders</p>
    </div>

    <div class="mt-12 grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3">
      {testimonials.map((testimonial) => (
        <article class="flex h-full flex-col rounded-2xl border border-[#e6dac5] border-l-4 border-l-[#d4af37] bg-[#fdf6e6] p-6 shadow-sm">
          <div class="text-lg tracking-wide text-[#d4af37]" aria-label="5 out of 5 stars">
            {starIcons.map((star) => (
              <span aria-hidden="true">{star}</span>
            ))}
          </div>

          <blockquote class="mt-4 flex-1 text-[1.02rem] italic leading-relaxed text-[#3f3126]">
            “{testimonial.quote}”
          </blockquote>

          <p class="mt-5 text-sm font-semibold text-[#2d1810]">{toDisplayName(testimonial.name)}</p>
          <p class="mt-1 text-sm text-[#5b4c3f]">{testimonial.service}</p>
          <p class="mt-1 text-sm text-[#7a6a57]">{testimonial.location}</p>
        </article>
      ))}
    </div>
  </div>
</section>
